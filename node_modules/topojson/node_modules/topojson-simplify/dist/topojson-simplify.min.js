// https://github.com/topojson/topojson-simplify Version 3.0.0. Copyright 2017 Mike Bostock.
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("topojson-client")):"function"==typeof define&&define.amd?define(["exports","topojson-client"],n):n(r.topojson=r.topojson||{},r.topojson)}(this,function(r,n){"use strict";function t(){return!0}function e(r){return r}function o(r){return null!=r.type}function a(r){var n=r[0],t=r[1],e=r[2];return Math.abs((n[0]-e[0])*(t[1]-n[1])-(n[0]-t[0])*(e[1]-n[1]))/2}function i(r){for(var n,t=-1,e=r.length,o=r[e-1],a=0;++t<e;)n=o,o=r[t],a+=n[0]*o[1]-n[1]*o[0];return Math.abs(a)/2}function u(r,n){return r[1][2]-n[1][2]}function c(r){return[r[0],r[1],0]}function l(r,n){if(t=r.length){if((n=+n)<=0||t<2)return r[0];if(n>=1)return r[t-1];var t,e=(t-1)*n,o=Math.floor(e),a=r[o];return a+(r[o+1]-a)*(e-o)}}function f(r,n){return n-r}function s(r,n){for(var t,e,o,a=0,i=r.length,u=0,c=r[n?a++:i-1],l=c[0]*A,f=c[1]*A/2+_,s=L(f),p=T(f);a<i;++a){c=r[a],t=l,l=c[0]*A,f=c[1]*A/2+_,e=s,s=L(f),o=p,p=T(f);var b=l-t,y=b>=0?1:-1,g=y*b,h=o*p,m=e*s+h*L(g),v=h*y*T(g);u+=E(v,m)}return u}function p(r,n){var t=s(r,!0);return n&&(t*=-1),2*(t<0?k+t:t)}function b(r){var n=s(r,!1);return 2*(n<0?k+n:n)}var y=function(r){function n(r){var t;switch(r.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:r.geometries.map(n)};break;case"LineString":t={type:"LineString",arcs:e(r.arcs)};break;case"MultiLineString":t={type:"MultiLineString",arcs:r.arcs.map(e)};break;case"Polygon":t={type:"Polygon",arcs:r.arcs.map(e)};break;case"MultiPolygon":t={type:"MultiPolygon",arcs:r.arcs.map(o)};break;default:return r}return null!=r.id&&(t.id=r.id),null!=r.bbox&&(t.bbox=r.bbox),null!=r.properties&&(t.properties=r.properties),t}function t(r){var n,t=r<0&&(r=~r,!0);return null==(n=s[r])&&(s[r]=n=++f,l[n]=c[r]),t?~n:n}function e(r){return r.map(t)}function o(r){return r.map(e)}var a,i=r.objects,u={},c=r.arcs,l=[],f=-1,s=new Array(c.length);for(a in i)u[a]=n(i[a]);return{type:"Topology",bbox:r.bbox,transform:r.transform,objects:u,arcs:l}},g=function(r,n){function a(r){var n,t;switch(r.type){case"Polygon":t=i(r.arcs),n=t?{type:"Polygon",arcs:t}:{type:null};break;case"MultiPolygon":t=r.arcs.map(i).filter(e),n=t.length?{type:"MultiPolygon",arcs:t}:{type:null};break;case"GeometryCollection":t=r.geometries.map(a).filter(o),n=t.length?{type:"GeometryCollection",geometries:t}:{type:null};break;default:return r}return null!=r.id&&(n.id=r.id),null!=r.bbox&&(n.bbox=r.bbox),null!=r.properties&&(n.properties=r.properties),n}function i(r){return r.length&&u(r[0])?[r[0]].concat(r.slice(1).filter(c)):null}function u(r){return n(r,!1)}function c(r){return n(r,!0)}var l,f=r.objects,s={};null==n&&(n=t);for(l in f)s[l]=a(f[l]);return y({type:"Topology",bbox:r.bbox,transform:r.transform,objects:s,arcs:r.arcs})},h=function(r){function n(r){switch(r.type){case"GeometryCollection":r.geometries.forEach(n);break;case"Polygon":t(r.arcs);break;case"MultiPolygon":r.arcs.forEach(t)}}function t(r){for(var n=0,t=r.length;n<t;++n,++a)for(var e=r[n],i=0,u=e.length;i<u;++i){var c=e[i];c<0&&(c=~c);var l=o[c];o[c]=l>=0&&l!==a?-1:a}}var e,o={},a=0;for(e in r.objects)n(r.objects[e]);return function(r){for(var n,t=0,e=r.length;t<e;++t)if(n=r[t],o[n<0?~n:n]<0)return!0;return!1}},m=function(r,t,e){return t=null==t?Number.MIN_VALUE:+t,null==e&&(e=i),function(o,a){return e(n.feature(r,{type:"Polygon",arcs:[o]}).geometry.coordinates[0],a)>=t}},v=function(r,n,t){var e=h(r),o=m(r,n,t);return function(r,n){return e(r,n)||o(r,n)}},d=function(){function r(r,n){for(;n>0;){var t=(n+1>>1)-1,o=e[t];if(u(r,o)>=0)break;e[o._=n]=o,e[r._=n=t]=r}}function n(r,n){for(;;){var t=n+1<<1,a=t-1,i=n,c=e[i];if(a<o&&u(e[a],c)<0&&(c=e[i=a]),t<o&&u(e[t],c)<0&&(c=e[i=t]),i===n)break;e[c._=n]=c,e[r._=n=i]=r}}var t={},e=[],o=0;return t.push=function(n){return r(e[n._=o]=n,o++),o},t.pop=function(){if(!(o<=0)){var r,t=e[0];return--o>0&&(r=e[o],n(e[r._=0]=r,0)),t}},t.remove=function(t){var a,i=t._;if(e[i]===t)return i!==--o&&(a=e[o],(u(a,t)<0?r:n)(e[a._=i]=a,i)),i},t},x=function(r,t){function e(r){i.remove(r),r[1][2]=t(r),i.push(r)}var o=r.transform?n.transform(r.transform):c,i=d();null==t&&(t=a);var u=r.arcs.map(function(r){var n,a,u,c=[],l=0;for(r=r.map(o),a=1,u=r.length-1;a<u;++a)n=[r[a-1],r[a],r[a+1]],n[1][2]=t(n),c.push(n),i.push(n);for(r[0][2]=r[u][2]=1/0,a=0,u=c.length;a<u;++a)n=c[a],n.previous=c[a-1],n.next=c[a+1];for(;n=i.pop();){var f=n.previous,s=n.next;n[1][2]<l?n[1][2]=l:l=n[1][2],f&&(f.next=s,f[2]=n[2],e(f)),s&&(s.previous=f,s[0]=n[0],e(s))}return r});return{type:"Topology",bbox:r.bbox,objects:r.objects,arcs:u}},j=function(r,n){var t=[];return r.arcs.forEach(function(r){r.forEach(function(r){isFinite(r[2])&&t.push(r[2])})}),t.length&&l(t.sort(f),n)},M=function(r,n){n=null==n?Number.MIN_VALUE:+n;var t=r.arcs.map(function(r){for(var t,e=-1,o=0,a=r.length,i=new Array(a);++e<a;)(t=r[e])[2]>=n&&(i[o++]=[t[0],t[1]]);return i.length=o,i});return{type:"Topology",transform:r.transform,bbox:r.bbox,objects:r.objects,arcs:t}},P=Math.PI,k=2*P,_=P/4,A=P/180,E=Math.atan2,L=Math.cos,T=Math.sin;r.filter=g,r.filterAttached=h,r.filterAttachedWeight=v,r.filterWeight=m,r.planarRingArea=i,r.planarTriangleArea=a,r.presimplify=x,r.quantile=j,r.simplify=M,r.sphericalRingArea=p,r.sphericalTriangleArea=b,Object.defineProperty(r,"__esModule",{value:!0})});